import React, { useState } from "react";
import { motion } from "framer-motion";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";

const questions = [
  {
    question: "Quando foi o nosso primeiro beijo depois de voltarmos a nos falar?",
    options: [
      "14 de fevereiro de 2025",
      "15 de fevereiro de 2025", // Resposta Correta (√≠ndice 1)
      "16 de fevereiro de 2025",
      "13 de fevereiro de 2025",
    ],
    correct: 1,
  },
  {
    question: "Qual √© a minha comida favorita?",
    options: [
      "Pizza",
      "Hamb√∫rguer",
      "Parmegiana", // AGORA ESTA √â A RESPOSTA CORRETA (√≠ndice 2)
      "Macarr√£o",
    ],
    correct: 2, // AJUSTADO PARA O √çNDICE DA "Parmegiana"
  },
  {
    question: "Qual o apelido carinhoso que eu mais gosto de ouvir de voc√™?",
    options: ["Dengo", // Resposta Correta (√≠ndice 0)
    "Amor", "Princesa", "Vida"],
    correct: 0,
  },
  {
    question: "Qual foi o momento mais especial pra mim com voc√™ at√© hoje?",
    options: [
      "Nosso primeiro encontro",
      "Quando tivemos uma conversa profunda sobre nossos sentimentos", // Resposta Correta (√≠ndice 1)
      "Nosso primeiro almo√ßo juntos",
      "Quando viajamos juntos",
    ],
    correct: 1,
  },
  {
    question: "Qual √© a minha anima√ß√£o favorita?",
    options: [
      "Hora de Aventura", // Resposta Correta (√≠ndice 0)
      "Rick & Morty",
      "Bananas de Pijamas",
      "Jovens Tit√£s",
    ],
    correct: 0,
  },
];

const QuizApp = () => {
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [score, setScore] = useState(0);
  const [showFinalPage, setShowFinalPage] = useState(false);
  const [selectedOptionIndex, setSelectedOptionIndex] = useState(null); // Para controlar a op√ß√£o selecionada na pergunta atual

  const handleOptionClick = (index) => {
    setSelectedOptionIndex(index); // Marca a op√ß√£o clicada

    if (index === questions[currentQuestion].correct) {
      setScore(score + 1);
    }

    // Pequeno atraso para o usu√°rio ver a sele√ß√£o antes de ir para a pr√≥xima pergunta
    setTimeout(() => {
      if (currentQuestion + 1 < questions.length) {
        setCurrentQuestion(currentQuestion + 1);
        setSelectedOptionIndex(null); // Reseta para a pr√≥xima pergunta
      } else {
        // Verifica se o score √© igual ao total de perguntas antes de mostrar a p√°gina final
        if (score + (index === questions[currentQuestion].correct ? 1 : 0) === questions.length) {
          // Adiciona 1 ao score se a √∫ltima resposta for correta para a verifica√ß√£o final
          setShowFinalPage(true);
        } else {
          // Se n√£o acertou todas, pode redirecionar para uma p√°gina de "tente novamente"
          // Ou simplesmente n√£o mostrar a p√°gina final (mantendo na √∫ltima pergunta)
          // Para este caso, vamos mostrar a p√°gina final APENAS se acertar todas
          // Caso contr√°rio, o quiz simplesmente termina sem a mensagem especial.
          // Voc√™ pode adicionar um else if aqui para uma mensagem de "n√£o acertou todas"
          alert("Ops! Voc√™ n√£o acertou todas as perguntas. Tente novamente!"); // Ou outra mensagem
          // Resetar o quiz ou ir para uma p√°gina de resultado de "n√£o acertou todas"
          setCurrentQuestion(0); // Reinicia o quiz se n√£o acertou tudo
          setScore(0);
          setShowFinalPage(false);
        }
      }
    }, 500); // Atraso de 0.5 segundos
  };

  return (
    <div className="flex flex-col items-center justify-center h-screen bg-pink-100">
      {showFinalPage ? (
        <motion.div
          className="relative flex flex-col items-center text-center bg-white rounded-2xl p-6 shadow-lg max-w-sm mx-4" // Adicionado mx-4 para margem lateral em telas menores
          initial={{ opacity: 0, y: 50 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.8 }}
        >
          {/* Anima√ß√£o de fundo (pode remover se n√£o quiser) */}
          <motion.div
            className="absolute inset-0 pointer-events-none"
            animate={{ y: [0, -10, 0], scale: [1, 1.1, 1] }}
            transition={{ repeat: Infinity, duration: 2 }}
          >
            {/* Div bg-red-200 removida, pois pode ter sido um placeholder */}
            {/* Pode adicionar confetes ou cora√ß√µes aqui */}
          </motion.div>
          <h1 className="text-3xl font-extrabold text-pink-600 mb-4 animate-pulse">
            Parab√©ns por ter acertado todas gatinho! üíñ
          </h1>
          <img
            src="/foto-do-casal.jpg" // CAMINHO CORRIGIDO! A imagem deve estar na pasta 'public'
            alt="Foto do casal"
            className="w-40 h-40 rounded-full object-cover border-4 border-pink-300 shadow-md mt-4 mb-6"
          />
          <p className="text-gray-700 text-base leading-relaxed text-left">
            Obrigada por ser esse homem incr√≠vel na minha vida. Por ser t√£o
            incr√≠vel, carinhoso e paciente comigo, at√© nos momentos em que nem
            eu consigo lidar comigo mesma.
            <br /><br />
            Voc√™ tem sido uma presen√ßa leve, firme e acolhedora, e eu percebo
            isso em cada gesto seu. No jeito como me escuta, como se importa,
            como me enxerga at√© quando eu mesma n√£o me reconhe√ßo.
            <br /><br />
            A sua paci√™ncia tem sido uma ponte pra minha cura. E sua forma de
            cuidar, mesmo quando n√£o diz nada, me faz sentir segura. Nem sempre
            √© f√°cil, eu sei. Somos dois seres com hist√≥rias, dores, receios e
            bagagens...
            <br /><br />
            Tem gente que passa pela vida da gente e nem deixa rastro. Mas tem
            pessoas que chegam e aos poucos viram lar ‚Äî e eu te sinto assim:
            abrigo, afeto e verdade.
            <br /><br />
            Obrigada por cada detalhe. Pelo esfor√ßo. Pela escuta. Pelos
            sil√™ncios. Por estar do meu lado, n√£o s√≥ nos dias f√°ceis, mas nos
            dias em que tudo parece um caos. Por ser paz onde tudo j√° foi
            barulho.
            <br /><br />
            Essa mensagem √© s√≥ um pedacinho da minha gratid√£o. Mas espero que
            ela te lembre do quanto voc√™ faz diferen√ßa. Voc√™ √© especial. E eu
            vejo isso em voc√™ todos os dias. üíû
          </p>
        </motion.div>
      ) : (
        <Card className="w-96 p-4"> {/* Adicionado p-4 para padding interno */}
          <CardContent className="flex flex-col items-center">
            {/* NOVO TEXTO ADICIONADO AQUI */}
            <p className="text-lg text-pink-700 font-semibold italic mb-4">
              O quanto voc√™ me conhece Dengo? ü§î 
            </p>
            <h2 className="text-xl font-semibold text-pink-600 mb-6 text-center">
              {questions[currentQuestion].question}
            </h2>
            <div className="mt-4 space-y-3 w-full">
              {questions[currentQuestion].options.map((option, index) => (
                <motion.button
                  key={index}
                  className={`w-full p-4 text-left border border-pink-200 rounded-lg focus:outline-none 
                              ${selectedOptionIndex === index 
                                 ? (index === questions[currentQuestion].correct ? 'bg-green-200' : 'bg-red-200')
                                 : 'bg-white hover:bg-pink-50'
                              }
                              ${selectedOptionIndex !== null ? 'pointer-events-none' : ''} // Desabilita cliques adicionais na mesma pergunta
                            `}
                  whileTap={{ scale: 0.95 }}
                  onClick={() => handleOptionClick(index)}
                  disabled={selectedOptionIndex !== null} // Desabilita bot√µes ap√≥s a sele√ß√£o
                >
                  {option}
                </motion.button>
              ))}
            </div>
            {/* Opcional: Contador de perguntas */}
            <p className="text-sm text-gray-500 mt-6">
              Pergunta {currentQuestion + 1} de {questions.length}
            </p>
          </CardContent>
        </Card>
      )}
    </div>
  );
};

export default QuizApp;